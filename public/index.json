[{"categories":["red team"],"content":"Intro Hello folks👋, I will be talking today about the recent incdient of the XZ Utils backdoor that compromised a lot of linux distributions across the world. This incident made the headlines. We are going to dive deep into the intricacies and about how this sophisticated attack came to be. This type of attack falls under the type of supply chain attack targeting the XZ Utils project, aimed at embedding a backdoor within linux systems. We’ll explore the sequence of events leading up to the attack’s discovery. Discuss the mechanisms the attacker used, assess the potential repercussions had the attack remained undetected, and reflect on the critical lessons this incident teaches us about cyber security in open-source projects. Finally, I will wrap up with lessons learned, a detailed lab environment and the importance of vigilence and proactive security measures in the open-source ecosystem. ","date":"2024-04-08","objectID":"/xzbackdoor/:1:0","tags":["backdoor","linux"],"title":"CVE-2024-3094 - XZ Linux Backdoor Analysis","uri":"/xzbackdoor/"},{"categories":["red team"],"content":"Understanding the Attack On Mar 29, 2024 at 12:00PM ET, Andres Freund posted on the Openwall mailing list about a backdoor he discovered in the XZ Utils package. The backdoor targeted the OpenSSH binary, allowing remote code execution on impacted machines. This backdoor was not located in the GitHub repository, but only in release versions of the package, which hid its presence. Due to the reason XZ Utils had been installed (directly or indirectly) on billions of Linux systems worldwide, this discovery shocked the international Linux and infosec communities. ","date":"2024-04-08","objectID":"/xzbackdoor/:2:0","tags":["backdoor","linux"],"title":"CVE-2024-3094 - XZ Linux Backdoor Analysis","uri":"/xzbackdoor/"},{"categories":["red team"],"content":"Understanding the timeline of the attack In late 2021, “Jia Tan”, an online identity, began a long and careful supply-chain attack with the goal of inserting a backdoor into Linux systems. Jia Tan submitted multiple contribution requests to several projects, including the XZ Utils project, and began harrasing Lasse Collin and other open source maintainers through various sock puppet accounts to get their XZ contributions accepted and ultimately, by late 2022, Jia Tan became a maintainer of the XZ project. During 2023 and early 2024, Jia Tan started making multiple changes to various open-source projects. This included submitting a merge request to google/oss-fuzz , which developers use to validate their code. Apparently, the goal of this update was to take ownership of the XZ Utils project and disable specific features in order to hide certain errors that could reveal the planned backdoor. Finally, in early 2024, Jia Tan released XZ Utils 5.6.0 as a tarball, which is the most common method of releasing software on GitHub. Specifically, they performed two commits that added “test” files that included the backdoor in the released version of the software. Since these were binary files, and not plain text, the “test” files were more obfuscated from the community. Following the release of version 5.6.0, Jia Tan rushed out a 5.6.1 release in an attempt to fix some failures that were occurring with the backdoor, with the hope of fixing them before they were spotted. In total, Jia Tan made at least 450 commits to the XZ GitHub, beginning on June 10, 2022. Eventually, on March 29, 2024 at 12:00PM ET, Andres Freund noticed a delay in the operation of SSH when running unstable version of Debian. Without the discovery of this SSH delay and various valgrind test errors, the community may not have discovered this vulnerability until it had run its course, infecting untold thousands or millions of machines. Despite the discovery of this vulnerability, the community is still wrestling with the potential scale and ramifications of the attack. Russ Cox presented an excellent detailed timeline of this attack, and @rheaeve posted an informative timezone investigation , both of which served as outstanding community resources. ","date":"2024-04-08","objectID":"/xzbackdoor/:3:0","tags":["backdoor","linux"],"title":"CVE-2024-3094 - XZ Linux Backdoor Analysis","uri":"/xzbackdoor/"},{"categories":["red team"],"content":"Grasping the Technical Overview of the Attack To summarize, the widely-used XZ utils package, which contains the xz and the liblzma library, contained the obfuscated code that created a backdoor in the OpenSSH service on many linux systems using XZ utils versions (5.6.0 -\u003e 5.6.1). This supply-chain attack was executed over trust-buildng campaign spanning two years🤯. From a technical standpoint, the backdoor was created when the tarball was generated for release tag. In other words, the backdoor was not created if the user built the tool manually from it’s git repo. Thus, it is safe to assume the attacker was mainly targetting Debian and RPM-based systems which depend on this tarball for their package installers. Alternatively, systems that do not rely on this method of packaging, such as Arch Linux, were not impacted by this vulnerability. I love arch btw💘😉. ","date":"2024-04-08","objectID":"/xzbackdoor/:4:0","tags":["backdoor","linux"],"title":"CVE-2024-3094 - XZ Linux Backdoor Analysis","uri":"/xzbackdoor/"},{"categories":["red team"],"content":"Assessing the Potential Impact of the Attack What makes this tremendously dangerous and attractive for such sophisticated attacks is that XZ utils is widely used over 3 billion machines, lightweight, easy to use and widely available. Given the widespead usage of this package, this attack could have impacted the security of linux systems worldwide, specially those that are running OpenSSH. The impact of this would have been devastating. Put simply, it’s possible that this vulnerability could have granted Jia Tan and his allies or sponsors open access to every affected internet facing SSH server, globally, including those run by governments and high profile global entities. This attack had the potential to weaken the global linux security posture and could have triggered untold millions of dollars in damages, or worse, it could have affected global infrastucture or even the health and safety of countless citizens. ","date":"2024-04-08","objectID":"/xzbackdoor/:5:0","tags":["backdoor","linux"],"title":"CVE-2024-3094 - XZ Linux Backdoor Analysis","uri":"/xzbackdoor/"},{"categories":["red team"],"content":"Learning from the incident Let’s review some of the potential lessons that we can learn from this incident. First, this high-profile attack has raised concerns about the security and trustworthiness of the open-source projects. At the same time, the open-source process of testing and collective effort worked in this case, as the vulnerability was discovered before it getting pushed from unstable to stable distributions. In addition, the discovery of this sophisticaed attack raises questions regarding the safety of other open-source projects that may have already been struck with a similar fate. This incident has highlighted the fact that solo open-source developers of high-profile projects are often overwhelmed. We cant simply completely rely on one person to do everything. We have to ensure that developers, maintainers and contributors are trustworthy. We also need to develop tools, techniques and procedures tha tensure the validity and the safety of our code, especially binary objects and their components. Finally, we must develop and implement tools, techniques and procedures that help detect not only supply-chain attacks but also the systems affected by these attacks in the event of breach. ","date":"2024-04-08","objectID":"/xzbackdoor/:6:0","tags":["backdoor","linux"],"title":"CVE-2024-3094 - XZ Linux Backdoor Analysis","uri":"/xzbackdoor/"},{"categories":["red team"],"content":"Testing Lab In this lab, I will be deploying two machines, Kali(backdoored package installed) and Debian(clean package). The Debian machine will serve as a baseline as we discuss the behavioral analysis that led to the discovery of this backdoor. First I will add two entries to the hosts file in our VM machines. Modified hosts file Here as you can see we have the backdoored version of the package to install on kali VM. It can be obtained from the Debian package snapshots. Kali VM malicious XZ Package After getting the vulnerable package, it’s time to instasll it with sudo apt-get install -y --allow-downgrades ./liblzma5_5.6.1-1_amd64.deb then we need to reload static library object of the vulnerable version with sudo systemctl restart ssh now our kali machine is vulnerable to CVE-2024-3094. Let’s check it out. First, let’s detect if this version of liblzma contains the backdoor. We’ll use Vegard Nossom’s script, detect.sh which was provided in the disclosure . The script is already located in the home directory. Let’s use cat to view the script and analyze it. ┌──(abdo💀rog)-[~/Downloads] └─$ cat detect.sh #! /bin/bash set -eu # find path to liblzma used by sshd path=\"$(ldd $(which sshd) | grep liblzma | grep -o '/[^ ]*')\" # does it even exist? if [ \"$path\" == \"\" ] then echo probably not vulnerable exit fi # check for function signature if hexdump -ve '1/1 \"%.2x\"' \"$path\" | grep -q f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410 then echo probably vulnerable else echo probably not vulnerable fi The script uses ldd to list the shared libraries loaded by the sshd binary and then searches for liblzma_ to determine its path. Then, the command hexdump -ve '1/1 \"%.2x\"' \u003c\u003cfile\u003e\u003e will dump the sshd binary in hexadecimal form, without any formatting, producing a long hex string. The script then searches for a hexadecimal pattern that serves as a signature for the backdoor. As a result, if the script finds the signature, our binary has been backdoored. Let’s run the script on the kali-backdoor machine first. Script showing the package is vulnerable In the next section, we’ll use behavioral anlysis to identify this backdoor without needing to log into the servers. ","date":"2024-04-08","objectID":"/xzbackdoor/:7:0","tags":["backdoor","linux"],"title":"CVE-2024-3094 - XZ Linux Backdoor Analysis","uri":"/xzbackdoor/"},{"categories":["red team"],"content":"Confirm that the SSH Daemon is Slower than Usual This vulnerability was discovered because of a small delay in the SSH rseponse time caused by peaks of CPU usage consumed by the sshd service. This anomaly remained unnoticed until Andres Freund ran a benchmark. Let’s check this in our small lab. We’ll SSH into both machines and compare their behaviors. Showing the difference in timing between SSH Both commands produced a “Permission denied” error message. This is expected since we didn’t submit valid authentication keys. However, the output of the time command, specifically the real value, reveals the time it took the command to present the error message. Although the real values may vary depending on many factors, the vulnerable machine clearly took longer to respond. We can repeat these exercise many times and each time, the backdoored machine will take longer to respond. This is exactly what Andres Freund noticed, which drove him to dive deeper in his investigation. We could write a custom scanner to test this, allowing us to remotely determine if a server has potentially been backdoored. Until next time cyaa.👋 ","date":"2024-04-08","objectID":"/xzbackdoor/:8:0","tags":["backdoor","linux"],"title":"CVE-2024-3094 - XZ Linux Backdoor Analysis","uri":"/xzbackdoor/"},{"categories":["siem","projects"],"content":"Background story first Hello there👋, welcome again to one of my blogs. This time we are going to talk about Wazuh SIEM. Here is a bit of a background as to what it is. Wazuh SIEM or as more professionally called a Security Identity and Event Management platform / system that aggregates and collects all logs from different sources across the organization’s network and and various assets to consolidate it into a single central dashboard for easy management and monitoring along with easier remedeation and faster repsonse times to alerts and attacks. It is a very well known SIEM platform among other solutions in the infosec industry. ","date":"2023-10-09","objectID":"/wazuh/:1:0","tags":["blue teaming"],"title":"Wazuh SIEM","uri":"/wazuh/"},{"categories":["siem","projects"],"content":"The inner works of Wazuh So to learn more I am going to explain it’s main features and were it shines compared to the others in the industry. Also, where it may fall short and might be improved. Wazuh works by installing agents on different operating systems with very small footprint. Those agents are configured during installation to connect back to a central component of the Wazuh platform called Wazuh Manager this is a very high level overview of how it basically works. There are three different main components that are required to be present in order for the Wazuh SIEM to function as intended to alert and protect your environment. Wazuh Server Wazuh Dashboard Wazuh Indexer ","date":"2023-10-09","objectID":"/wazuh/:2:0","tags":["blue teaming"],"title":"Wazuh SIEM","uri":"/wazuh/"},{"categories":["siem","projects"],"content":"Wazuh Indexer, What is it? The Wazuh indexer is a highly scalable, full-text search and analytics engine. A Wazuh core component that indexes and stores alerts generated by the Wazuh server and provides near real-time data search and analytics capabilities. Wazuh Indexer ","date":"2023-10-09","objectID":"/wazuh/:2:1","tags":["blue teaming"],"title":"Wazuh SIEM","uri":"/wazuh/"},{"categories":["siem","projects"],"content":"Wazuh Dashboard, What the wolf sees… The Wazuh dashboard is where you will see all the alerts and notifications about your environment. You will get to interact with what matters if any asset is missing compliance or vulnerable to some critical CVE. You will have a bird-eye view super power🦅. Wazuh Dashboard PCI-DSS Monitoring As you can see from the above image of the Wazuh Dashboard you might have noticed the PCI DSS word up there, yes you are not dreaming🤯. One of the main features of Wazuh SIEM is the ability to monitor compliance for your environment mapping to different frameworks such as NIST one of the most popular main cybersecurity frameworks and PCI-DSS for the payment card industry. Making it easy to monitor and stay compliant and effective at minimizing efforts of your cyber force. Vulnerability Detection Another neat feature of Wazuh SIEM is the vulnerability detection module. This module handles the auto detection of vulnerabilities from a locally fetched database image of the NVD (National Vulnerability Database). You can of course set the update interval and the date range vulnerabilities to fetch. The module detects operating system vulnerabilities and it’s currently installed applications on it. Wazuh Vuln Dashboard You can move forward and invesitigate all the agents with Critical and high vulnerabilities to limit your exposure to cyber attacks. This will highly reduce the attack surface specially because it scans all installed applications on the systems the agent is installed on. File Integrity Monitoring Another specially neat feature is the full system monitoring feature which monitors all specified important and critical directories and files for any modifications. Any slight change or moditication to the system file or other files or directories you specify for it monitor will be monitored by generating a hash of it. One of the main pillars of cyber security triad CIA is integrity which can be achieved by monitoring any changes to the file system by using hashing algorithms were applicable. Here in our case hashing is used to monitor each and every file for modifications, as any slight change will change the hash completely. Wazuh FIM Module Integrations There are many other features to talk about but I will not be covering them all as this will be quite the extensive blog. But another good thing that wazuh possess is the ability to integrate with other well known security vendors for enhanced work flow or abilities using powerfull APIs. Some of these integrations are Virustotal, Slack, PagerDuty, Shuffle, or you can make your own custom integration if you can program the API to do so😉. If you do a little search about all the previously mentioned API integrations you will notice something, and that is all of these integrations will help automate and create a full network of sorts for the cyber team to be more and well integrated to automatically notice and respond to alerts generated by the wazuh SIEM streamlining the process. ","date":"2023-10-09","objectID":"/wazuh/:2:2","tags":["blue teaming"],"title":"Wazuh SIEM","uri":"/wazuh/"},{"categories":["siem","projects"],"content":"Conclusion We didnt discuss all it’s feature set since this will take a lot of time and the blog would extend more. However, this open-source SIEM solution is very convenient for companies that don’t want to dish out a ton of budget or are limited with funds contraint when implementing a SIEM solution to protect their environment, this doesn’t subtract from it’s outstanding performance and feature set. If you need a wolf to watch over your environment for cyber and malicious network packets or file modifications you don’t have to think hard this is good, give it a try for yourself. Until we meet next time in another blog post👋. A roaming wolf that seeks its target 🐺. ","date":"2023-10-09","objectID":"/wazuh/:3:0","tags":["blue teaming"],"title":"Wazuh SIEM","uri":"/wazuh/"},{"categories":[],"content":" My name is Abdelaal Abdelghaffar code-named: w01V3RINE. I’m a cybersecurity professional with a strong interest in ethical hacking, penetration testing, vulnerability analysis, and network security. Hard-working, energetic, personable, and technical-minded individual. Possess exceptional customer service and communication skills with the strong ability to multitask and resolve issues quickly. I am currently in a cybersecurity role where I continue to develop and learn new abilities while contributing to the overall success of the organization. Skillz Level Python programming Excellent Bash scripting Great Burpsuite Great Red teaming Good Blue teaming Excellent Incident response Great Threat hunting Great OSINT Good Risk analysis \u0026 assessment Great Vulnerability management Great ","date":"2023-10-09","objectID":"/about/:0:0","tags":[],"title":"","uri":"/about/"},{"categories":["Code","Projects"],"content":"Introduction Hello there👋, I thought of making a small project to better grasp the python programming language and at the same time make something relevant to what I like a mini cyber project.😊 So I thought what should I do?🤔 Ahaa! I know a small program that suggests better passwords than what most people come up with like password😒, \u003cinsert username\u003e\u003csome year\u003e😒 or iloveyou😒 which are all very easy to guess and bruteforce. So I started grinding away as usual, let’s check the simple password generator below. ","date":"2023-10-09","objectID":"/passwordgen/:1:0","tags":["Python","Password"],"title":"Password Generator","uri":"/passwordgen/"},{"categories":["Code","Projects"],"content":"Program This is a password generator program written in python. Few libraries were used in this program to simplify the program and decrease written lines of code as much as possible. First of all we import the necessary libraries. Random to generate random ints, and string to populate the data lower, upper, digits and symbols. import random import string We then ask for the user input, initiating the program and determining the length of the password. print(\"hello, welcome to password generator!\") length = int(input(\"\\nEnter the length of the password:\")) Assign variables containing the letters, nums, and symbols from library. lower = string.ascii_lowercase upper = string.ascii_uppercase nm = string.digits symbols = string.punctuation Append all variables to one variable, in addition to that we randomize the generated string of password saving it to a temporary variable. Finally we move it from temp to a password variable to be printed. all = lower + upper + nm + symbols temp = random.sample(all, length) password = \"\".join(temp) print(password) ","date":"2023-10-09","objectID":"/passwordgen/:2:0","tags":["Python","Password"],"title":"Password Generator","uri":"/passwordgen/"},{"categories":["Code","Projects"],"content":"Moral of the story Hope this small program has peaked your interest to discover more and more importantly develop more complex passwords. At least next time you think about making a new account on some website remember to use something similar such a Password Manager or think of some hard password to guess😉. Until next time see ya👋. ","date":"2023-10-09","objectID":"/passwordgen/:3:0","tags":["Python","Password"],"title":"Password Generator","uri":"/passwordgen/"},{"categories":["Stories"],"content":"Introduction CyberTalents Scholarship is one of those really well known scholarships that is well sought after by many young aspiring cybersecurity individuals. This scholarship is formed and established by two well known entities, CyberTalents platform and TREND MICRO who’s specialized in cloud and cybersecurity solutions. The scholarship application consisted of two parts. First part was to fill a general form asking about some personal information, experience, track you want to pursue. Second part is the tough one an assessment part made up of topics along with appropriately selected challenges to dive deep and solve. These challenges are in the form of CTF (Capture The Flag) style. ","date":"2023-10-09","objectID":"/cybertalents/:1:0","tags":["Scholarship"],"title":"Cybertalents Scholarship","uri":"/cybertalents/"},{"categories":["Stories"],"content":"Flash back First of all a small flashback to a funny story. If you read the previous post about IELTS Academic exam you will know that I didn’t have the time to complete or even start the assessment part the application which consists of 29 challenges. The IELTS exam was on 29th a day before the end of registration for CT scholarship. These challenges tackle a wide range of cybersecurity topics from OSINT, web security, to reverse engineering and much more. Luckily, CT moderators decided to extend the scholarship time frame 15 days more until the 15th of May. This was like a god sent moment. Although I’m still working a full time job, I dedicated all my time out side of job hours to this part of the scholarship in hopes to get accepted. I really felt like this scholarship will turn the tides of my life and career, because I will get to meet tons of like minded people and professionals in the field with years of experience. ","date":"2023-10-09","objectID":"/cybertalents/:2:0","tags":["Scholarship"],"title":"Cybertalents Scholarship","uri":"/cybertalents/"},{"categories":["Stories"],"content":"Thrill of reversing As the deadline almost caught up to me, 14th of May midnight I was still stuck in one particular challenge concerning the topic of RE (reverse engineering). I felt that I have to finish the rest of the remaining challenges first before giving my fully undivided attention to RE challenge. To be honest, I haven’t really took a deep dive into RE until this moment so that was really tough. But some coffee and dedication can do wonders, lets not forget some YT videos lol. Finally, manages to solve the challenge and notified the CT team. When you spend lots of time doing something that challenges you, but never get tired, bored or quit and keep persevering towards your goals, thats when you know you have found your passion. Fast forward to 19th of May 2021, almost midnight after a crappy day got an email you have been accepted into the DFIR (Digital Forensics Incident Response) track also known with another name as blue teaming. That moment couldn’t contain my excitement, as I was still shocked considering how small the pool of the scholarship when compared to applying individuals from different Arabic and African nations. ","date":"2023-10-09","objectID":"/cybertalents/:3:0","tags":["Scholarship"],"title":"Cybertalents Scholarship","uri":"/cybertalents/"},{"categories":["Stories"],"content":"Close call Getting accepted in this scholarship is a dream come true you might say, getting to know may people and interact with professionals in this sexy field is something that can’t be bought or exchanged for. I hope to learn from them and benefit each and everyone of them, in addition hope to help, benefit and contribute tremendously to the cybersecurity field. More to come stay tuned, everything related to Reverse Engineering untli then see ya👋 ","date":"2023-10-09","objectID":"/cybertalents/:4:0","tags":["Scholarship"],"title":"Cybertalents Scholarship","uri":"/cybertalents/"}]